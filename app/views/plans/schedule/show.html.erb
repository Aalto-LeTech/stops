<% content_for :javascript do %>
  <%= javascript_include_tag 'period' %>
  <%= javascript_include_tag 'course' %>
  <%= javascript_include_tag 'courseinstance' %>
  <%= javascript_include_tag 'plan' %>
<% end %>

<div class="leftNavi">
  <button id="save-button">Save</button>
</div>
  
<div class="content">
  <h1><%=t :plan_heading %></h1>

  <% if @user.courses.empty? && @user.competences.empty? %>
    <%= t :plan_empty_instructions %>
  <% end %>

  <p id="status"></p>

  <div class="plan" id="plan" data-prereqs-path="<%= prereqs_curriculum_path(@curriculum.id) %>" data-instances-path="<%= course_instances_path %>">
    <% @periods.each do |period| %>
      <div class="period period-<%= period.number %>" data-id="<%= period.id %>" id="period-<%= period.id %>">
        <div class="period-name"><%= period.name(I18n.locale) %></div>
        <div class="period-credits"></div>
      </div>
    <% end %>
    
    
    <% @user_courses.each do |user_course| %>
      <% next unless user_course %>
      
      <div class="course" id="course-<%= user_course.scoped_course.code %>" data-id="<%= user_course.id %>" data-code="<%= user_course.scoped_course.code %>" data-credits="<%= user_course.scoped_course.credits || '0' %>" data-passed="<%= user_course.passed? ? 'true' : 'false' %>" data-period="<%= user_course.course_instance_id ? user_course.course_instance.period_id : '' %>" ><%= h(user_course.scoped_course.code) + ' ' + h(user_course.scoped_course.name(I18n.locale)) %></div>
    <% end %>
  </div>

  <table>
    <tr>
      <td>Courses:</td><td><%= @user_courses.size %></td>
    </tr>
  </table>
</div>